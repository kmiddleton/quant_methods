<!DOCTYPE html>
<html>
  <head>
    <title>Applications of Inference Frameworks</title>
    <meta charset="utf-8">
    <meta name="author" content="Elizabeth King and Kevin Middleton" />
    <link href="libs/remark-css-0.0.1/example.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle

# Applications of Inference Frameworks
## Quantitative Methods in Life Sciences
### Elizabeth King and Kevin Middleton
### Last updated: 2016-12-03

---




# Notes

---

# Readings

---

# Three Frameworks

1. Frequentist
2. Maximum likelihood
3. Bayesian

---

# Estimating a mean

---

# Linear Regression

`$$Y=a+bX$$`

Where

- `\(Y\)` is the response variable
- `\(X\)` is the explanatory variable
- `\(a\)` is the `\(Y\)`-intercept (`\(Y\)` when `\(X=0\)`)
- `\(b\)` is the slope of the line

---

# Linear Regression

`$$Y = \theta_1 + \theta_2 X$$`

Where

- `\(Y\)` is the response variable
- `\(X\)` is the explanatory variable
- `\(\theta_1\)` is `\(\alpha\)` for which `\(a\)` is the estimate (`\(\hat{\alpha} = a\)`)
- `\(\theta_2\)` is `\(\beta\)` for which `\(b\)` is the estimate (`\(\hat{\beta} = b\)`)

---

# Linear Regression

What values of `\(\theta_1\)` and `\(\theta_2\)` provide the best fit line through `\(Y\)` as a function of `\(X\)`?

`$$Y = \theta_1 + \theta_2 X$$`

How do we estimate `\(\theta_1\)` and `\(\theta_2\)`?

---

# Generate data

Generate `\(n=30\)` random data points: `\(X \sim \mathcal{N}(10, 1)\)` and `\(Y = 2.3 X + \epsilon\)`, where `\(\epsilon \sim \mathcal{N}(1, 1)\)`:


```r
set.seed(4)
n &lt;- 30
X &lt;- rnorm(n, mean = 10, sd = 1)
Y &lt;- 2.3 * X + rnorm(n, mean = 1, sd = 1)
M &lt;- data.frame(X, Y)
M %&gt;% head()
```

```
##           X        Y
## 1 10.216755 24.65200
## 2  9.457507 23.80420
## 3 10.891145 25.29542
## 4 10.595981 23.88857
## 5 11.635618 28.62305
## 6 10.689275 25.18081
```

---

# Generate data

&lt;img src="05_Applications_of_Inference_files/figure-html/unnamed-chunk-1-1.png" width="672" /&gt;

---

# Solve analytically

`\(Y\)` is a (n x 1) vector of observed values
`\(X\)` is an (n X 2) matrix of ones followed by observations

`$$\theta = (X'X)^{-1} X'Y$$`

Where `\(X'\)` is the transpose of `\(X\)` and `\(X{-1}\)` is the inverse [See: https://www.mathsisfun.com/algebra/matrix-inverse.html].


```r
(X_mat &lt;- matrix(c(rep(1, n), X), ncol = 2))
```

```
##       [,1]      [,2]
##  [1,]    1 10.216755
##  [2,]    1  9.457507
##  [3,]    1 10.891145
##  [4,]    1 10.595981
##  [5,]    1 11.635618
##  [6,]    1 10.689275
##  [7,]    1  8.718753
##  [8,]    1  9.786855
##  [9,]    1 11.896540
## [10,]    1 11.776863
## [11,]    1 10.566604
## [12,]    1 10.015719
## [13,]    1 10.383057
## [14,]    1  9.954863
## [15,]    1 10.034352
## [16,]    1 10.169027
## [17,]    1 11.165027
## [18,]    1  9.955796
## [19,]    1  9.899632
## [20,]    1  9.716555
## [21,]    1 11.540815
## [22,]    1 10.165169
## [23,]    1 11.307622
## [24,]    1 11.288257
## [25,]    1 10.592897
## [26,]    1  9.717056
## [27,]    1 11.255884
## [28,]    1 10.909839
## [29,]    1  9.071972
## [30,]    1 11.240181
```

---

# Solve analytically


```r
(theta &lt;- (solve(t(X_mat) %*% X_mat)) %*% (t(X_mat) %*% Y))
```

```
##             [,1]
## [1,] -0.03540546
## [2,]  2.39524849
```

`theta` is a 2 x 1 matrix of coefficients:

$$
\theta=\left[\begin{array}{c}
-0.035\\
2.395
\end{array}\right]
$$

---


```r
lm_fast &lt;- function(X, Y) {
  X_mat &lt;- matrix(c(rep(1, n), X), ncol = 2)
  theta &lt;- (solve(t(X_mat) %*% X_mat)) %*% (t(X_mat) %*% Y)
  return(theta)
}

predict_Y &lt;- function(theta, X) {
  Y_hat &lt;- theta[1, 1] + theta[2, 1] * X
  return(Y_hat)
}

log_lik &lt;- function(Y, Y_hat) {
  var_hat &lt;- sum((Y - Y_hat)^2) / (length(Y))
  sd_hat &lt;- sqrt(var_hat)
  probs_Y &lt;- dnorm(Y, mean = Y_hat, sd = sd_hat)
  return(sum(log(probs_Y)))
}
```

---


```r
theta &lt;- lm_fast(X, Y)
Y_hat &lt;- predict_Y(theta, X)
(LL &lt;- log_lik(Y, Y_hat))
```

```
## [1] -40.25821
```

---
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github"
});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
